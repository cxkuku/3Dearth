# jm-service

活动相关api服务调用

### 安装

```
$ jnpm install @jmfe/jm-service --save
```

组件的 ajax 调用依赖于浏览器新的 fetch 方法; 如果需要老的浏览器支持，请自行安装 [whatwg-fetch](https://www.npmjs.com/package/whatwg-fetch) polyfill 来抹平浏览器的差异。

### 测试

```
$ npm test
```

### API

广告组和商品组接口中的isMain参数表示是否在大促主会场使用该接口，functionId会有所不同

- jsonp(apiBase: string, params: object, opts: object): Promise

- ajax
    - ajax.get(url: string, param: object, opts: object): Promise
    - ajax.post(url: string, param: object, opts:object): Promise
    
- getAdvGroups(ids: string | string[], isMain?: boolean): Promise

- getProductGroups(ids: string | string[], today?: boolean ): Promise
- getProductGroupsCurStage(ids: string | string[], isMain?: boolean): Promise
- getProductGroupStage(groupId: string, stageId: string, isMain?: boolean): Promise
- getProductGroupStages(groupId: string, num: number, position?: number, isMain?: boolean): Promise

- makeAppointment(moduleId: string): Promise

- booking(skuId: string): Promise
- getBookingInfo(activityId: string, skuId: string): Promise

- getLuckyDrawInfo(activityId: string, pageId: string, moduleId: string): Promise
- doLuckyDraw(activityId: string, pageId: string, moduleId: string): Promise

- addToCart(skuId: string, sid?: string, needLogin?: number): Promise
	 - sid 默认空字符串''
	 - needLogin 是否需要登录才能加购物车,0不需要登录，1需要登录

- verifyNewUser(): Promise

- getShareInfo(activityId: string, pageId: string): Promise

- getDiscoveryInventoryList(page: number, lastId: number, tag?: string): Promise 
   - 参考：http://cf.jd.com/pages/viewpage.action?pageId=80795260

- verifyPlusAndNewUser(): Promise 

- doLuckyDrawAsync(): Promise 
	- 异步抽奖接口，与老抽奖接口用法一致。抽奖组件类型不同

- getRankCates(): Promise

- getRankParty(): Promise

- setCDNConf(cdnConfig: array)
    - 传入静态数据配置数据
